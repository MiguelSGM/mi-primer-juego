<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DEEP App</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --azul-deep: #007bff;
            --azul-oscuro: #001f3f;
            --blanco: #ffffff;
            --fondo: #f0f7ff;
            --azul-brillante: #00d4ff;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--fondo); overflow: hidden;
        }

        /* --- PANTALLAS --- */
        .screen {
            position: fixed; inset: 0; display: none;
            flex-direction: column; padding: 20px; z-index: 10;
        }
        .screen.active { display: flex; }

        /* --- PANTALLA 1: BIENVENIDA --- */
        #screen-welcome { 
            justify-content: center; align-items: center; 
            background: linear-gradient(180deg, var(--azul-oscuro) 0%, var(--azul-deep) 100%);
            color: white; text-align: center;
        }
        .big-logo { font-size: 6rem; font-weight: 900; letter-spacing: 10px; margin: 0; color: var(--blanco); text-shadow: 0 0 20px rgba(255,255,255,0.5); }
        .lema-principal { font-size: 1.2rem; margin: 20px 0; font-style: italic; color: var(--azul-brillante); }
        
        /* Formulario Registro */
        #registration-box { display: none; flex-direction: column; gap: 15px; width: 85%; max-width: 350px; }
        .marquee-container { overflow: hidden; white-space: nowrap; margin-bottom: 10px; }
        .marquee-text { display: inline-block; animation: marquee 15s linear infinite; font-weight: bold; color: yellow; }
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        input, select {
            padding: 15px; border-radius: 12px; border: 2px solid var(--azul-brillante);
            background: white; font-size: 1rem; outline: none;
        }
        .btn-start { 
            background: var(--blanco); color: var(--azul-deep); border: none; 
            padding: 15px 40px; border-radius: 50px; font-size: 1.3rem; font-weight: 900; 
            cursor: pointer; transition: transform 0.2s;
        }

        /* --- INTERFAZ APP --- */
        .top-header { display: flex; padding: 10px; position: absolute; top: 0; left: 0; }
        .deep-med { font-size: 2rem; font-weight: 800; color: var(--azul-deep); cursor: pointer; }

        .main-container {
            flex: 1; margin-top: 60px; margin-bottom: 100px;
            display: flex; flex-direction: column; overflow: hidden;
        }

        /* HOME PAGE TEXTO GIGANTE */
        #home-view { height: 100%; display: flex; flex-direction: column; justify-content: flex-end; }
        .home-text-container {
            font-size: 1.8rem; font-weight: 700; text-align: justify;
            line-height: 1.1; color: #003366; padding: 10px;
        }
        .lema-home { font-size: 2.2rem; font-style: italic; color: var(--azul-deep); display: block; margin-bottom: 15px; }

        /* LISTA SESIONES */
        #sessions-list { display: none; flex-direction: column-reverse; gap: 15px; overflow-y: auto; padding: 10px; }
        .card-session {
            background: white; padding: 20px; border-radius: 20px;
            border: 3px solid var(--azul-deep); box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .card-session h3 { font-size: 2rem; margin: 0; color: var(--azul-deep); }

        /* CRON√ìMETRO */
        .timer-view { align-items: center; justify-content: center; text-align: center; }
        .timer-header { width: 100%; display: flex; justify-content: flex-end; align-items: center; gap: 10px; margin-bottom: 20px; }
        .clock-num { font-size: 5.5rem; font-weight: 900; color: var(--azul-oscuro); font-family: monospace; margin: 30px 0; }
        .btn-pause { background: var(--azul-deep); color: white; border: none; padding: 20px; border-radius: 50%; width: 90px; height: 90px; }

        /* ESTADISTICAS */
        .stats-row { display: flex; justify-content: space-between; align-items: center; margin: 40px 0; }
        .stat-box { text-align: center; flex: 1; }
        .stat-num { font-size: 5rem; font-weight: 900; color: var(--azul-deep); display: block; }
        .stat-txt { font-weight: bold; color: #555; }

        /* NAVEGACI√ìN (2CM DISTANCIA) */
        .nav-bottom {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: var(--blanco); padding: 15px 30px; border-radius: 40px;
            display: flex; gap: 75px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 2px solid var(--azul-deep); z-index: 100;
        }
        .nav-btn { color: #ccc; cursor: pointer; transition: 0.3s; }
        .nav-btn.active { color: var(--azul-deep); transform: scale(1.2); }

        /* MODAL */
        #modal-finish {
            position: fixed; inset: 0; background: rgba(0,31,63,0.95);
            display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px;
        }
        .modal-content { background: white; padding: 30px; border-radius: 30px; width: 100%; text-align: center; }
    </style>
</head>
<body>

    <section id="screen-welcome" class="screen active">
        <h1 class="big-logo">DEEP</h1>
        <p class="lema-principal">"Sumerge tu mente en el oc√©ano del conocimiento" üåä</p>
        <button id="btn-pre-start" class="btn-start" onclick="showReg()">Empecemos üöÄ</button>

        <div id="registration-box">
            <div class="marquee-container">
                <span class="marquee-text">"La inteligencia consiste no solo en el conocimiento, sino tambi√©n en la destreza de aplicar los conocimientos en la pr√°ctica." ‚Äî Arist√≥teles üß†</span>
            </div>
            <input type="text" id="reg-name" placeholder="üë§ Tu nombre de usuario...">
            <input type="text" id="reg-fav" placeholder="‚≠ê Tu asignatura favorita...">
            <button class="btn-start" onclick="saveUser()">Entrar üö™</button>
        </div>
    </section>

    <section id="screen-app" class="screen">
        <div class="top-header">
            <div class="deep-med" onclick="nav('home')">DEEP</div>
        </div>

        <div class="main-container">
            <div id="view-home" class="view">
                <div id="home-intro" class="home-text-container">
                    <span class="lema-home">Sumerge tu mente en el oc√©ano del conocimiento üåä</span>
                    üëã Bienvenido a <span style="color:var(--azul-deep)">DEEP</span>, la mejor web para impulsar tus estudios. üìö Est√°s en tu men√∫, aqu√≠ ver√°s las sesiones de estudio que a√±adas de ahora en adelante. ‚ú®
                    <br><br>
                    ‚ûï Si clicas a <span style="color:var(--azul-deep)">"a√±adir"</span>, podr√°s meter todas las sesiones de estudio que quieras. üìù
                    <br><br>
                    üìä En <span style="color:var(--azul-deep)">"estad√≠sticas"</span>, podr√°s ver todo lo que has estudiado este mes, a√±o o semana, adem√°s de gr√°ficos y m√°s detalles. üìà
                    <br><br>
                    üåà ¬°Disfruta de tu experiencia en <span style="color:var(--azul-deep)">DEEP</span>! üíé
                </div>
                <div id="sessions-list"></div>
            </div>

            <div id="view-add" class="view" style="display:none;">
                <div class="timer-view">
                    <div class="timer-header">
                        <select id="sel-subject" onchange="checkOther(this)">
                            <option value="Matem√°ticas‚ûï">Matem√°ticas‚ûï</option>
                            <option value="Ingl√©süá∫üá∏">Ingl√©süá∫üá∏</option>
                            <option value="Lengua Castellana y Literatura üá™üá∏">Lengua üá™üá∏</option>
                            <option value="Otra">Otra</option>
                        </select>
                        <input type="text" id="input-other" placeholder="¬øCual?" style="display:none; width:100px">
                        <button class="btn-start" style="padding:10px 15px; background:red; color:white;" onclick="stopClock()">Terminar üèÅ</button>
                    </div>
                    <div class="clock-num" id="clock-txt">00:00:00</div>
                    <button class="btn-pause" onclick="toggleClock()" id="btn-p">
                        <i data-lucide="pause" size="40"></i>
                    </button>
                </div>
            </div>

            <div id="view-stats" class="view" style="display:none; text-align: center;">
                <h2 style="color:var(--azul-deep)">Tus Logros üèÜ</h2>
                <div class="stats-row">
                    <div class="stat-box">
                        <span class="stat-num" id="st-count">0</span>
                        <span class="stat-txt">Sesiones üìÅ</span>
                    </div>
                    <div style="width:100px"></div>
                    <div class="stat-box">
                        <span class="stat-num" id="st-hours">0</span>
                        <span class="stat-txt">Horas ‚è≥</span>
                    </div>
                </div>
                <div class="stat-box" style="margin: 30px 0;">
                    <span class="stat-num" id="st-streak" style="color: #ff6b6b;">0</span>
                    <span class="stat-txt">D√≠as de Racha üî•</span>
                </div>
                <div class="stat-box">
                    <span class="stat-txt">Asignatura Estrella ‚≠ê</span>
                    <div id="st-top" style="font-size: 2.5rem; font-weight: 800; color: var(--azul-deep);">-</div>
                </div>
            </div>

            <div id="view-notes" class="view" style="display:none;">
                <h2 style="color:var(--azul-deep)">Tus Notas üìù</h2>
                <textarea style="width:100%; height:300px; border-radius:20px; padding:20px;" placeholder="Escribe aqu√≠ tus apuntes importantes..."></textarea>
            </div>
        </div>

        <nav class="nav-bottom">
            <div class="nav-btn active" onclick="nav('home', this)"><i data-lucide="home" size="30"></i></div>
            <div class="nav-btn" onclick="nav('add', this)"><i data-lucide="plus-circle" size="30"></i></div>
            <div class="nav-btn" onclick="nav('stats', this)"><i data-lucide="bar-chart-2" size="30"></i></div>
            <div class="nav-btn" onclick="nav('notes', this)"><i data-lucide="sticky-note" size="30"></i></div>
        </nav>
    </section>

    <div id="modal-finish">
        <div class="modal-content">
            <h2>¬°Sesi√≥n Completada! üåü</h2>
            <div class="clock-num" id="modal-time" style="font-size: 3rem;">00:00:00</div>
            <input type="text" id="session-title" placeholder="Nombre de la sesi√≥n (ej: √Ålgebra)" style="width:100%; margin-bottom:20px;">
            <button class="btn-start" style="background:var(--azul-deep); color:white; width:100%" onclick="saveSession()">Guardar en el men√∫ üì•</button>
        </div>
    </div>

    <script>
        lucide.createIcons();
        let timer = null, secs = 0, isPaused = false, fireOk = false;
        let db = JSON.parse(localStorage.getItem('deep_db')) || {
            user: '', fav: '', sessions: [], streak: 0, lastDate: null, subTime: {}
        };

        window.onload = () => {
            if(db.user) {
                document.getElementById('screen-welcome').style.display = 'none';
                document.getElementById('screen-app').classList.add('active');
                renderSessions();
                updateStats();
            }
        };

        function showReg() {
            document.getElementById('btn-pre-start').style.display = 'none';
            document.getElementById('registration-box').style.display = 'flex';
        }

        function saveUser() {
            db.user = document.getElementById('reg-name').value || "Estudiante";
            db.fav = document.getElementById('reg-fav').value || "Estudio";
            localStorage.setItem('deep_db', JSON.stringify(db));
            location.reload();
        }

        function nav(v, btn) {
            document.querySelectorAll('.view').forEach(x => x.style.display = 'none');
            document.getElementById('view-' + v).style.display = 'flex';
            document.querySelectorAll('.nav-btn').forEach(x => x.classList.remove('active'));
            if(btn) btn.classList.add('active');
            if(v === 'add' && !timer && secs === 0) startClock();
        }

        function checkOther(s) { document.getElementById('input-other').style.display = s.value === 'Otra' ? 'inline-block' : 'none'; }

        function startClock() {
            isPaused = false; updateIcon();
            timer = setInterval(() => {
                secs++;
                updateUI();
                if(secs === 1800 && !fireOk) {
                    confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                    fireOk = true;
                }
            }, 1000);
        }

        function toggleClock() {
            if(isPaused) startClock();
            else { clearInterval(timer); timer = null; isPaused = true; updateIcon(); }
        }

        function updateIcon() {
            const i = document.getElementById('btn-p');
            i.innerHTML = isPaused ? `<i data-lucide="play" size="40"></i>` : `<i data-lucide="pause" size="40"></i>`;
            lucide.createIcons();
        }

        function updateUI() {
            const h = Math.floor(secs / 3600).toString().padStart(2, '0');
            const m = Math.floor((secs % 3600) / 60).toString().padStart(2, '0');
            const s = (secs % 60).toString().padStart(2, '0');
            document.getElementById('clock-txt').innerText = `${h}:${m}:${s}`;
        }

        function stopClock() {
            clearInterval(timer); timer = null;
            document.getElementById('modal-time').innerText = document.getElementById('clock-txt').innerText;
            document.getElementById('modal-finish').style.display = 'flex';
        }

        function saveSession() {
            let sub = document.getElementById('sel-subject').value;
            if(sub === 'Otra') sub = document.getElementById('input-other').value || 'Otra';
            const title = document.getElementById('session-title').value || "Sesi√≥n";
            const today = new Date().toLocaleDateString();

            db.sessions.push({ title, sub, time: document.getElementById('clock-txt').innerText, date: today, s: secs });
            db.subTime[sub] = (db.subTime[sub] || 0) + secs;

            if(secs >= 1800) {
                const day = new Date().toDateString();
                if(db.lastDate !== day) { db.streak++; db.lastDate = day; }
            }

            localStorage.setItem('deep_db', JSON.stringify(db));
            location.reload();
        }

        function renderSessions() {
            if(db.sessions.length > 0) {
                document.getElementById('home-intro').style.display = 'none';
                const list = document.getElementById('sessions-list');
                list.style.display = 'flex';
                db.sessions.forEach(s => {
                    const el = document.createElement('div');
                    el.className = 'card-session';
                    el.innerHTML = `<h3>${s.title} üìù</h3><div style="display:flex; justify-content:space-between; color:var(--azul-deep); font-weight:bold;"><span>${s.sub}</span><span>${s.date} üìÖ</span></div><div style="font-size:2.5rem; font-family:monospace; margin-top:10px;">${s.time} ‚è±Ô∏è</div>`;
                    list.appendChild(el);
                });
            }
        }

        function updateStats() {
            document.getElementById('st-count').innerText = db.sessions.length;
            const total = db.sessions.reduce((a, b) => a + b.s, 0);
            document.getElementById('st-hours').innerText = (total / 3600).toFixed(1);
            document.getElementById('st-streak').innerText = db.streak;
            let top = "-"; let max = 0;
            for(let k in db.subTime) { if(db.subTime[k] > max) { max = db.subTime[k]; top = k; } }
            document.getElementById('st-top').innerText = top;
        }
    </script>
</body>
</html>
